{% extends "core/base.html" %}

{% block title %}Study Planner | Tasks{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">

    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-semibold text-gray-700">My Tasks</h2>
        <a href="{% url 'create_task' %}"
           class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-white border border-gray-400 hover:text-gray-900 hover:underline">
            + New Task
        </a>
    </div>
    
    {% if tasks %}
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for task in tasks %}
                <div class="bg-white rounded-xl shadow p-5 border border-gray-200">

                    <div class="flex justify-between items-start">
                        <h3 class="text-lg font-semibold text-gray-800">
                            {{ task.title }}
                        </h3>

                        <span class="
                            px-2 py-1 text-xs rounded
                            {% if task.priority == 'high' %}
                                bg-red-100 text-red-600
                            {% elif task.priority == 'medium' %}
                                bg-yellow-100 text-yellow-600
                            {% else %}
                                bg-green-100 text-green-600
                            {% endif %}
                        ">
                            {{ task.priority|capfirst }}
                        </span>
                    </div>

                    {% if task.description %}
                        <p class="text-gray-600 text-sm mt-2">
                            {{ task.description }}
                        </p>
                    {% endif %}

                    <div class="text-sm text-gray-500 mt-4 space-y-1">
                        {% if task.due_date %}
                            <p>
                                <i class="fa-regular fa-calendar"></i>
                                Due: {{ task.due_date|date:"M d, Y" }}
                            </p>
                        {% endif %}

                        {% if task.duration %}
                            <p>
                                <i class="fa-regular fa-clock"></i>
                                {{ task.duration }} min
                            </p>
                        {% endif %}
                    </div>

                    <div class="mt-5 flex justify-between items-center">
                        <span class="text-xs text-gray-400">
                            Created {{ task.created_at|timesince }} ago
                        </span>

                        <a href="{% url 'mark_complete' task.id %}"
                            class="text-green-600 hover:underline text-sm">
                                Mark Complete
                        </a>
                    </div>

                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="bg-white rounded-lg shadow p-10 text-center text-gray-500">
            ðŸŽ‰ No pending tasks! You're all caught up.
        </div>
    {% endif %}

</div>
{% endblock %}
